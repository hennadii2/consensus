Sequential investments with stage-specific risks and drifts